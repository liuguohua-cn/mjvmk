<html>
<title>Folsena Microsystems - Embedded real-time operating systems integrating native and java threads</title>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="TITLE" CONTENT="Folsena Microsystems - Embedded real-time operating systems integrating native and java threads">
<META NAME="KEYWORDS" CONTENT=", ">
<link rel="stylesheet" type="text/css" href="style.css" title="master">


<script>
var im1 = new Image();
var im2 = new Image();
var im3 = new Image();
var im4 = new Image();
var im5 = new Image();
im1.src = 'home2.gif';
im2.src = 'prod2.gif';
im3.src = 'spec2.gif';
im4.src = 'down2.gif';
im5.src = 'cont2.gif';


function switchIm(im, newSrc) {
	if(document.images != null)
		im.src=newSrc;
}

</script>


<body bgcolor=#ebeaf0 topmargin=0 leftmargin=0 marginwidth=0 marginheight=0>

<!-- div id=logo-->
<!-- img src=logo3.gif-->
<!-- /div-->




<table border=0 cellspacing=0 cellpadding=0 cols=4 rows=5 width=822>

<tr><td height=30 width=200 bgcolor=#ffffff valign=top align=right><img src=topleft3.gif></td>

<td bgcolor=#000000 width=526><img src=menul2.gif><a border=0 href="home.htm" onMouseOver="switchIm(homeIm1, 'home2.gif');" onMouseOut="switchIm(homeIm1, 'home1.gif');"><img name=homeIm1 src=home1.gif border=0></a><a border=0 href="products.htm" onMouseOver="switchIm(productIm1, 'prod2.gif');" onMouseOut="switchIm(productIm1, 'product1.gif');"><img src=product1.gif name=productIm1 border=0></a><a border=0 href="specs.htm" onMouseOver="switchIm(specsIm1, 'spec2.gif');" onMouseOut="switchIm(specsIm1, 'specs1.gif');"><img src=specs1.gif name=specsIm1 border=0></a><a border=0 href="download.htm" onMouseOver="switchIm(downloadIm1, 'down2.gif');" onMouseOut="switchIm(downloadIm1, 'downloa1.gif');"><img src=downloa1.gif name=downloadIm1 border=0></a><a border=0 href="contact.htm" onMouseOver="switchIm(contactIm1, 'cont2.gif');" onMouseOut="switchIm(contactIm1, 'contact1.gif');"><img src=contact1.gif name=contactIm1 border=0></a><img src=menur2.gif></td>
<td width=46 bgcolor=#000000 valign=top>&nbsp;</td>
<td width=50 rowspan=5 bgcolor=#dbdae0>&nbsp;</td>
</tr>


<tr>
<td width=200 height=20 bgcolor=#ffffff align=left><spacer type=block width=1></td>
<td width=526 bgcolor=#ffffff align=left><spacer type=block width=1></td>
<td width=46 bgcolor=#000000 valign=top><img border=0 src=tittopr6.gif></td>
</tr>

<tr>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!-- if extending the page length, increase as appropriate-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<td height=1750 bgcolor=#ffffff colspan=3>&nbsp;</td></tr>

<tr><td height=220 bgcolor=#ffffff colspan=3>&nbsp;</td></tr>

<tr>
<td colspan=3 align=center bgcolor=#dbdae0>
<br>
<span class=copyright>
&#169; Folsena Microsystems 2002.  All rights reserved.<br><br>
</span>
</td>
</tr>
</table>
<br>







<div id="leftNavBarDownload">
<!------ left side navigation bar -------->

<table rows=5 cols=1 cellpadding=0 cellspacing=0 border=0>

<tr><td width=101><img src=bmenut5.gif name=topLowIm></td></tr>

<tr><td align=center bgcolor=#000000 valign=top>
<table width=81 rows=1 cols=4 cellpadding=0 cellspacing=0 border=0>
<tr>
<td width=1 bgcolor=#f4f400><spacer type=block width=1></td>
<td width=78>
<a href="home.htm" onMouseOver="switchIm(homeIm2, 'home2.gif');" onMouseOut="switchIm(homeIm2, 'home1.gif');"><img border=0 name=homeIm2 src=home1.gif></a><br>
<a href="products.htm" onMouseOver="switchIm(productIm2, 'prod2.gif');" onMouseOut="switchIm(productIm2, 'product1.gif');"><img src=product1.gif name=productIm2 border=0></a><br>
<a href="specs.htm" onMouseOver="switchIm(specsIm2, 'spec2.gif');" onMouseOut="switchIm(specsIm2, 'specs1.gif');"><img src=specs1.gif name=specsIm2 border=0></a><br>
<a href="download.htm" onMouseOver="switchIm(downloadIm2, 'down2.gif');" onMouseOut="switchIm(downloadIm2, 'downloa1.gif');"><img src=downloa1.gif name=downloadIm2 border=0></a><br>
<a href="contact.htm" onMouseOver="switchIm(contactIm2, 'cont2.gif');" onMouseOut="switchIm(contactIm2, 'contact1.gif');"><img src=contact1.gif name=contactIm2 border=0></a><br>
</td>
<td width=2 bgcolor=#f4f400><spacer type=block width=2></td>
</tr>
</table>
</td></tr>

<tr><td bgcolor=#000000><img src=bmenub5.gif name=bottomLowIm></td></tr>

<tr><td bgcolor=#000000>
<p>&nbsp;</p>

</td></tr>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!-- if extending the page length, increase as appropriate-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<tr><td height=785 bgcolor=#dbdae0>
&nbsp;
</td></tr>

</table>

<!------ end left side navigation bar -------->
</div>






<!------ beginning of content ---------------->

<div id=content>

<table cols=4 cellspacing=0 cellpadding=0 border=0 width=772>

<tr>
<td width=112 height=0><!--extend this height to 80 to include the logo, while decreasing the height below by the same margin, and use the third column in this row for content--></td>
<td width=70 height=0></td>
<!--td width=474 height=0-->
<td width=530 height=0></td>
<td width=60 height=0></td>
</tr>

<tr>
<!-- if extending the page length, increase the height below by the required number of pixels-->
<td width=112 height=510>&nbsp;</td>
<td width=600 colspan=2 valign=top>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!--upper content starts here-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<span class=text>


<span class=text1><p>
Mavos Demos
</span></p>
These demos will run on Intel 386 compatible processors, such as the Intel Pentium I, MMX, II, III, IV and Pro.<br>
<span class=text2><p>
Basic Demo
</p></span>
<p>
The following demonstration runs diagnostic tests that illustrate numerous features of the virtual machine and underlying operating system.
</p>
<p>
Download <a href=demo1.zip>demo1</a><br>
Download the source <a href=Test.java>Test.java</a><br>
</p>
<p><span class=text3><b>Instructions</b></span></p>
<p>
<b>Step 1.</b> Write the bootloader psBoot.bin to the boot sector of a floppy disk.  In Windows you may use the "debug" command.  The debug command's disk write option has the following format:</p>
<p><span class=computerText>debug -w offset drive track sectors</span></p>
<p>By executing the following,</p>
<p><span class=computerText>debug psBoot.bin<br>
-w 0100 0 0 1<br>
-q<br>
</span></p>
<p>
you will load the file to memory at offset 0x100 (no segment address required), and write a single sector (512 bytes) to the sector 0 of the a: drive.  Be careful in using the debug command that you do not write to your hard drive.  Using a text file as input to the program is a safe way to do so.  You may use the batch file debugCmd.bat and its input file debugCmdIn.txt if you wish.
</p>
<p>
<b>Step 2.</b> Copy the operating system binary image demo1.bin to the floppy using a normal file copy.  It should be the only file on the floppy disk.
</p>
<p>
<b>Step 3.</b> Reboot your PC with the floppy inserted in the a: drive.
</p>
<p>
You should see the operating system load itself and run various diagnostic tests.  The source for these tests is the file <a href=Test.java>Test.java</a> which contains the class test.Test and numerous inner classes.  With the next demonstration you will be able to write your own java code to run on the system.
</p>
<p>
<br>
<br>
<br>





<span class=text2><p>
Advanced Demo
</p></span>
<p>
This demo allows you to run your own java code on Mavos.  You require Microsoft Visual Studio 6 or higher or a similar C compiler, and you must have a java compiler such as the one provided with the <a href=http://java.sun.com/downloads/index.html>Java 2 Platform Standard Edition (J2SE)</a> from Sun Microsystems.
</p>
<p>
Download <a href=demo2.zip>demo2</a><br>
</p>
<p><span class=text3><b>Instructions</b></span></p>

<p>
<b>Step 1.</b> Write your own java class "test.Test".  The system will attempt to locate the method "void main(String[])" in this class as the entry point.  You may include as many classes as you wish, although the bootloader will load up to a limit of 384 kb of data, so the final disk image must be under that size.  A typical <a href=products.htm#OSSize>disk image size</a> is around 230 kb.
</p>

<p>
<b>Step 2.</b> Use your java compiler to compile your code.  Note that the java code must be CLDC J2ME compliant, which means that if you use any of the J2SE API not present in J2ME CLDC and not supported by the system then an error will be thrown.
</p>











</span>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!--upper content ends here-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
</td>


<td>&nbsp;</td>
</tr>









<tr>
<td>&nbsp;<!--lower navigation bar lies here--></td>
<td>&nbsp;</td>
<td valign=top>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!--lower content starts here-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<br>
<br>
<span class=text>

<p>
<b>Step 3.</b> Use the encode utility to generate a source code file that will be included with the Visual Studio project.  The command line is: 
</p><p>
<span class=computerText>encode.exe listing.txt outputFile.c [-classpath dir1;dir2;...]</span>
</p><p>
The file listing.txt must contain a listing of all the java class files you wish to include, which will be the file test/Test.class and any additional files you have compiled (which must include compiler generated class files for inner classes).  You may specify a classpath to help the utility locate your files, otherwise it will search from the current directory.  There is an example of listing.txt provided, one that can be used with the java source from Demo 1.  Note that the utility will search for the class based on its package name (as is the usual case with Java), so the "test.Test" class file must be situated in a directory named "test".
</p>
<p>
<b>Step 4.</b> Open the Visual Studio workspace demo.dsw.  Your C source file must replace the file unlinkedStaticClassFiles.c in the Visual Studio project.  Select the file unlinkedStaticClassFiles.c in the workspace window and hit the delete key, and add your source file with the "Add to Project" menu listing under the "Project" menu option. Or simply replace the text in the unlinkedStaticClassFiles.c file with the text in your source file.  The file unlinkedStaticClassFiles.c is a source file produced from the java code used in the above demonstration and can be used as a reference.
</p>

<p>
<b>Step 5.</b> Build the project to produce a Windows executable demo.exe using the Build menu option.  The build process will compile your C source file into an object source file and link with the files psEntry.obj and lib.lib.
</p><p>
The project options are set to link an executable with a 0x0 base address. However, this linker always relocates the code 0x1000 bytes above the specified based address, putting the code at 0x1000. The bootloader takes this address into account by loading the code at address 0x1000 instead of 0x0.  Ignore any warnings that the base value of 0x0 is invalid for a Windows executable.
</p><p>

<b>Step 6.</b> Run the ExeToBin utility on the generated executable to generate a new operating system binary image.  The command line is:
</p><p>
<span class=computerText>ExeToBin.exe demo.exe demo2.bin</span>
</p><p>
<b>Step 7.</b> Complete all 3 steps of demo 1 with your new binary system image demo2.bin and the bootloader binary image psBoot.bin.
</p><p>
The system will load itself, jump into your java code and begin executing.
</p><p>
<br><br>
<b>Notes:</b></p><p> 
&#149;The system is configured with the following options: growable java thread stacks, a heap size of 1 MB, and garbage collection that will run when all of your threads go idle.<br><br>  
&#149;The file psEntry.obj must be included as the first file in the list of files to be linked with, so that this object source file appears first in the resulting executable.<br><br>
</p>






</span>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!--lower content ends here-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<td>&nbsp;</td>
</tr>







<tr>
<td width=112>&nbsp;</td>
<td width=600 colspan=2 valign=top>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!--even lower content starts here-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<br>
<br>
<span class=text>



&nbsp;


</span>
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<!--even lower content ends here-->
<!--XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
<td>&nbsp;</td>
</tr></table>


</div>

<!------ end of content ---------------->

</body>
</html>
